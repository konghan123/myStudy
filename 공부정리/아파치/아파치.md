아파치 설정
- httpd.conf 는 아파치 설정 파일 중 가장 중요한 파일
- 아파치 설정 이후 apachectl명령어의 configtest라는 옵션을 실행하여 설정파일 문법을 검사할 수 있음.
  (이상이 없는 경우 Syntax Ok라는 메세지를 뿌려줌)
  ![[Pasted image 20240313221403.png]]
- 설정파일 (각 설정파일들은 설정부분에서 주석(#)을 제거하면 적용됨)
	- httpd.conf
		- ServerRoot, ServerName, DocumentRoot와 같은 메인설정들을 정의하고 있음
		- 파일 마지막 부분에는 extra 디렉토리에 존재하는 11개의 설정파일들을 개별적으로 include하여 선택적으로 로딩 가능
		- ![[Pasted image 20240313222619.png]]아파치서버의 홈디렉토리를 지정하며 절대경로 지정 (이후로 나오는 대부분의 경로들은 이 경로를 루트로 하는 상대경로로 지정됨)
		- ![[Pasted image 20240313222751.png]]다른 IP Address와 포트에 대해서 연결할 수 있도록 해줌 (주로 맨뒤에 나오는 가상호스트부분에서 기본 80번이외에 다른 포트를 이용하여 가상호스트를 설정하고자 할때 필요)
		- ![[Pasted image 20240313223101.png]]아파치를 DSO(Dynamic Shared Object) 방식으로 설치한 다음 필요한 모듈을 아파치에 로드하는 지시자
			- ![[Pasted image 20240313223307.png]]위위 그림에서 로드한 모듈 "libphp5.so"로 직접 로딩되는 위치가 위 그림이다. 
			- LoadModule이라는 설정으로 아파치 실행중 각각 필요한 모듈들이 로딩되어 사용됨
			- 필요한 모듈파일들을 필요할 때마다 로딩하였다가 해제하는 방식의 동적로딩을 위한 설정 (아파치를 정적으로 설치한다면 필요 x )
			- /user/local/apache/bin/httpd -l을 실행하여 정적으로 설치된 모듈을 확인할 수 있음
			- 정적으로 설치된 아파치의 경우 실행과 종료될 때까지 항상 메모리에 로딩됨
		- ![[Pasted image 20240313224101.png]]User, Group은 홈페이지 서비스를 직접 담당하는 아파치 자식 프로세스들의 실행소유자와 소유그룹을 각각 어떤 계정으로 할지 결정하는 지시자 
			- 보통 nobody로 설정해둠 단, 해당 지시자를 root로 설정하면 안된다. 아파치웹서버의 모든 자식프로세스들이 root소유로 실행되며 웹서비스 자체가 root권한으로 실행됨을 의미
			- ![[Pasted image 20240313224454.png]]deamon 6788,6789,6790,6791,6792 프로세스들의 소유를 각각 어떤 계정이 소유로할 것인가를 지정함
			- 부모프로세스의 경우 root소유로 되어있는 6786프로세스이며 해당 프로세스에 의해 모든 아파치 자식 프로세스들을 fork시켜 생성한것이다. 
		- ![[Pasted image 20240313225236.png]]클라이언트에게 보여주는 호스트이름을 지정하는 지시자
			-   www를 쓰지 않는 호스트에서 www를 쓰는것처럼 보이게 할 수 있다.
			- 도메인이 없을 때 유용
		- ![[Pasted image 20240314205448.png]]Directory 지시자는 지정한 디렉토리 이하의 모든 웹문서들에 대한 제어를 어떤 방식으로 하는지 결정한다.
			- 해당 지시자는 여러개 존재가능
			- 옵션
				- Option
					- 지정한 디렉토리 이하에 모든 파일과 디렉토리들에 적용할 접근 제어 설정
					- 디렉토리 목록, CGI허용, SSI허용을 여기서 설정함
					- 설정항목![[Pasted image 20240314205828.png]]![[Pasted image 20240314210007.png]]![[Pasted image 20240314210028.png]]![[Pasted image 20240314210036.png]]
				- AllowOverride
					- 어떻게 접근을 허락할 것인가에 대한 설정
					- 특정 디렉토리에 대한 방문자들의 접근 방식을 어떤방식으로 허용할지 지정
					- 해당 설정 값은 중복하여 설정가능하며 가장최근에 설정된 값이 우선적용됨
					- 설정항목![[Pasted image 20240314210309.png]]![[Pasted image 20240314210319.png]]![[Pasted image 20240314210333.png]]
				- Order
					- 접근제어 순서를 의미
				- Deny/Allow from all
					- 모든 접근 거부
			- 추가 문법
				- ![[Pasted image 20240314210756.png]]해당 경로의 디렉토리에 대하여 지시자에 지정된 값들을 적용한다는 설정
					- ![[Pasted image 20240314211009.png]]
		- ![[Pasted image 20240314211054.png]]웹사이트 초기 페이지 문서로 어떤 파일을 사용할 것인지 지정하는 지시자
			- 웹주소로 들어올때 지정한 디렉토리에서 자동적으로 찾아서 보여줄 웹문서파일의 순서를 지정함 
			- 여러파일 지정가능하며 순서대로 보여줌(없으면 다음 순서 페이지 호출)
			- 최종적으로 지정한 모든 파일이 없을 경우 Options지시저에 indexs 또는 All이 지정되어 있는 경우 디렉토리 내 파일리스트를 보여줌
		- ![[Pasted image 20240314211447.png]].ht로 시작하는 파일의 내용을 웹에서 어떻게 보여줄지 또는 보여주지 않을지 지정하는 지시자
			- 보안 상 이유로 이 옵션은 설정해두는 것이 좋다
			- 특정 파일의 패턴에 해당하는 파일들의 로딩을 막기위해 주로 사용됨
			- 특정문자로 시작하는 파일 등 웹문서로 보여주지 않으려고 할때 유용
			- .ht만이 아니라 다른 문자열로 시작하는 파일에 대해서도 접근설정이 가능함
		- ![[Pasted image 20240314211717.png]]아파치 웹서버의 에러로그파일의 위치를 지정하는 지시자
		- ![[Pasted image 20240314211800.png]]설정한 에러로그 파일의 기록 내용을 얼마나 자세하게 기록할 것인지 지정하는 지시자
		- ![[Pasted image 20240314212353.png]]웹로그파일(access_log)에 방문자들에 대한 기록을 어떤 포맷으로 할것인지 포맷종류를 설정하는 지시자
			- 서버관리자는 유심히 봐야함
			- 원하는 정보를 지정해서 볼 수 있기에 관리자에게 필요한 포맷으로 설정하야하며 접속통계를 내기 적당한 포맷으로 설정해두어야함
		- ![[Pasted image 20240314212743.png]] 특정 디렉토리경로로 방문자가 로딩하였을 경우 지정된 다른 URL로 리다이렉트하는 지시자
			- /foo라는 디렉토리를 로딩요청하였을 경우 뒷 URL로 보여줌
		- ![[Pasted image 20240314212917.png]]CGI스크립트를 특정한 위치(뒷부분)에서만 제공하기 위한 설정
			- 웹서버 보안을 위한 설정
			- 어떤 위치에서든 CGI를 허용하면 보안에 문제가 생길 수 있어서 사용자들이 특정경로만의 CGI파일들만 사용할 수 있도록 지정
			-  ex. http://www.sulinux.net/cgi-bin/list.cgi 해당 list.cgi의 실제위치는 위사진 뒷부분 경로임
		- ![[Pasted image 20240314213508.png]]mode_cgid.c모듈이 로드되어 있다면 UNIX소켓을 사용할 수 있음
		- ![[Pasted image 20240314213605.png]]mime.types파일에 정의되어 있지 않은 파일 형식에 대한 요청을 받았을 경우 알 수 없는 문서타입에 대해 기본적인 타입을 지정해주는 설정 (윗그림은 일반 텍스트문서로 기본타입을 잡음)
		- ![[Pasted image 20240314213733.png]]mime.types파일을 어디에서 찾을 것인지 지정하는 지시자
			- 윗 그림은 /usr/local/apache/conf에서 해당 mime.types 파일을 찾게 설정
		- ![[Pasted image 20240314214925.png]]웹문서 에러 발생 시 응답을 정의할 수 있는 설정이다.
			- http에러에 대해 문자열, 페이지, URL등을 설정하여 응답을 줄 수 있음
		- ![[Pasted image 20240314215129.png]]메모리매핑 파일을 사용할지 설정하는 지시자
			- 메모리매핑을 지원하는 OS에서 아파치가 웹문서를 로딩하기 위해 내부문서를 읽을 때 메모리매핑하여 처리하므로 아파치성능을 크게 향상시킴
			- 하지만 이 지시자는 off설정하고 사용하지 않는 것을 권장
		- ![[Pasted image 20240314215357.png]]include 지시자를 통해 extra 디렉토리의 11개 설정파일들을 개별적으로 include하여 선택적으로 로딩할 수 있다. (윗그림은 httpd-mpm에 대한 설정파일을 include한 모습)
	- extra/httpd-mpm.conf
		- 아파치 웹서버의 MPM specific에 대한 설정파일
	- extra/httpd-multi-language errordoc.conf
		- 콘텐츠협상을 통한 에러문서 설정파일
	- extra/httpd-autoindex.conf
		- 디렉토리의 내용을 어떻게 로딩할 것인지에 관한 설정파일
		- ![[Pasted image 20240314220714.png]]Alias지시자
			- 기능
				- DocumentRoot 밖의 문서를 안쪽에서 사용하기 위함
				- 긴 이름을 짧게 줄여서 사용하기 위함
					- Alias /fakename(가상이름)/ /realname(절대경로)/
		- ![[Pasted image 20240314221303.png]] 디렉토리 지시자
		- 
	- extra/httpd-languages.conf
		- 다른 언어들을 어떻게 표현할지 설정파일
	- extra/httpd-userdir.conf
		- 사용자 홈디렉토리에 관환 설정파일
	- extra/httpd-info.conf
		- 아파치실행 모니터링 및 실행상태 정보를 설정하는 파일
	- httpd-vhosts.conf
		- 아파치 가상호스트에 대한 설정파일
	- extra/httpd-manual.conf
		- 아파치웹서버의 매뉴얼제공에 대한 설정파일
	- extra/httpd-dav.conf
		- WebDAV에 관한 아파치 설정파일
	- extra/httpd-default.conf
		- 아파치웹서버의 기본설정사항들이 설정되어있는 설정파일
	- extra/httpd-ssl.conf
		- SSL지원을 위한 아파치 설정파일